USE ESP_SQL_MOD_BAS
GO



/* EJECUTAR SOLO PARA CREAR EL SCHEMA
CREATE SCHEMA ESP_SQL_C7
GO
*/
/*
pk_producto			COD_PRODUCTO	....
1					PRO_0001		......
*/
CREATE TABLE ESP_SQL_C7.PRODUCTOS (
	PK_PRODUCTO INT PRIMARY KEY IDENTITY(1,1),
	COD_PRODUCTO AS 'PRO_' + RIGHT('0000' + CAST(PK_PRODUCTO AS VARCHAR(4)),4) PERSISTED,
	NOM_PRODUCTO VARCHAR(50),
	TIPO VARCHAR(20),
	PRECIO MONEY
)
GO

CREATE TABLE ESP_SQL_C7.ALMACEN (
	PK_ALMACEN INT PRIMARY KEY IDENTITY(1,1),
	COD_ALMACEN AS 'ALM_' + RIGHT('0000' + CAST(PK_ALMACEN AS VARCHAR(4)),4) PERSISTED,
	NOM_ALMACEN VARCHAR(50),
	AREA DECIMAL(7,3)
)
GO

CREATE TABLE ESP_SQL_C7.PRODUCTO_ALMACEN(
	FK_PRODUCTO INT FOREIGN KEY REFERENCES ESP_SQL_C7.PRODUCTOS(PK_PRODUCTO),
	FK_ALMACEN INT FOREIGN KEY REFERENCES ESP_SQL_C7.ALMACEN(PK_ALMACEN),
	STOCK INT,
	FECHA_ACTUALIZACION DATE
)
GO

INSERT 
INTO ESP_SQL_C7.ALMACEN(NOM_ALMACEN, AREA)
VALUES
	('ALM. ACHO', 233.5),
	('ALM. FLORIDA', 423.2),
	('ALM. JESUS MARIA', 674.3),
	('ALM. LOS OLIVOS', 356.0),
	('ALM. SAN BORJA', 693.5)
GO

INSERT 
INTO ESP_SQL_C7.PRODUCTOS(NOM_PRODUCTO, TIPO, PRECIO)
VALUES
	('MANZANAS', 'FRUTAS', 3.4),
	('PERAS', 'FRUTAS', 1.5),
	('SHAMPOO', 'LIMPIEZA', 10.3),
	('JABON', 'LIMPIEZA', 2.2),
	('LECHE', 'COMIDA', 3.3),
	('HUEVOS', 'COMIDA',9.8)
GO

INSERT 
INTO ESP_SQL_C7.PRODUCTO_ALMACEN (FK_PRODUCTO,FK_ALMACEN,STOCK,FECHA_ACTUALIZACION)
VALUES
	(1,1,4500,'2023-01-01'),
	(2,1,1000,'2023-01-01'),
	(3,1,1300,'2023-03-01'),
	(1,2,2300,'2023-05-01'),
	(1,3,5800,'2023-06-01'),
	(2,2,9750,'2023-05-01'),
	(2,1,45000,'2023-05-01'),
	(4,4,4200,'2023-04-01'),
	(4,1,6700,'2023-06-01'),
	(5,4,5600,'2023-07-01'),
	(3,2,9300,'2023-06-01')
GO
	
/*
DROP TABLE ESP_SQL_C7.PRODUCTO_ALMACEN
DROP TABLE ESP_SQL_C7.PRODUCTOS
DROP TABLE ESP_SQL_C7.ALMACEN
*/

SELECT * FROM ESP_SQL_C7.PRODUCTOS
SELECT * FROM ESP_SQL_C7.ALMACEN
SELECT * FROM ESP_SQL_C7.PRODUCTO_ALMACEN
GO

SELECT * FROM