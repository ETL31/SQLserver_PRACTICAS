-- PARTE 12
SELECT 
B.NOM_PRODUCTO, 
A.STOCK,
       CASE 
           WHEN STOCK < 3000 THEN 'Déficit'
           WHEN STOCK BETWEEN 3000 AND 6000 THEN 'Normal'
           ELSE 'Superavit'
       END AS CLASIFICACION
FROM ESP_SQL_C7.PRODUCTOS B
INNER JOIN ESP_SQL_C7.PRODUCTO_ALMACEN A
ON
    B.PK_PRODUCTO = A.FK_PRODUCTO

--PARTE 13
SELECT 
    CASE 
        WHEN STOCK < 3000 THEN 'Déficit'
        WHEN STOCK BETWEEN 3000 AND 6000 THEN 'Normal'
        ELSE 'Superavit'
    END AS CLASIFICACION,
    COUNT(*) AS CANT_REGISTROS
FROM 
    ESP_SQL_C7.PRODUCTO_ALMACEN
GROUP BY 
    CASE 
        WHEN STOCK < 3000 THEN 'Déficit'
        WHEN STOCK BETWEEN 3000 AND 6000 THEN 'Normal'
        ELSE 'Superavit'
    END

--PARTE 14
DELETE 
FROM ESP_SQL_C7.PRODUCTO_ALMACEN
WHERE 
STOCK > 10000


--PARTE 15 

--No encuentro porqué no cambia. 

--1° Forma
UPDATE A
SET A.STOCK = 6000
FROM ESP_SQL_C7.PRODUCTO_ALMACEN A
INNER JOIN ESP_SQL_C7.PRODUCTOS B 
ON 
  B.PK_PRODUCTO = A.FK_PRODUCTO
INNER JOIN ESP_SQL_C7.ALMACEN C
ON 
  C.PK_ALMACEN=A.FK_ALMACEN
WHERE
  C.NOM_ALMACEN = 'ALM.ACHO' AND B.NOM_PRODUCTO = 'MANZANA'

 --2da Forma
UPDATE ESP_SQL_C7.PRODUCTO_ALMACEN
SET STOCK = 6000
WHERE 
FK_PRODUCTO=(SELECT PK_PRODUCTO FROM ESP_SQL_C7.PRODUCTOS 
WHERE 
NOM_PRODUCTO = 'MANZANA') 
AND 
FK_ALMACEN = 
(SELECT 
PK_ALMACEN 
FROM ESP_SQL_C7.ALMACEN 
WHERE 
NOM_ALMACEN = 'ALM.ACHO')